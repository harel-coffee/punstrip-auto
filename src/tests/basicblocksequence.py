#!/usr/bin/python3
import sys
import unittest
import logging
import IPython

from classes.config import Config
from classes.symbol import Symbol
from classes.basicblocksequence import BasicBlockSequence
from classes.basicblock import BasicBlock
from classes.config import Config

import pyvex, archinfo



class TestBasicBlockSequence(unittest.TestCase):

    #config instance
    config = Config()

    def test_creation(self):
        bbs = self.create_bbs()
        #self.assertEqual(a.name, "who")

    def create_bbs(self):
        data = b'H\x85\xf6t3H\x8bF\x08H\x85\xc0t0f\x90H\x8b\x16H9\xfa\x7f\nH9\xc7|\x1bH9\xc2t\x16H\x83\xc6\x10H\x8bF\x08H\x85\xc0u\xe1\xf3\xc3\x0f\x1f\x80\x00\x00\x00\x00\xb8\x01\x00\x00\x00\xc31\xc0\xc3' 
        vaddr = 22432
        arch = 'x86_64'
        size = len(data)

        return BasicBlockSequence(TestBasicBlockSequence.config, bbs=[], data=data, vaddr=vaddr, arch=arch, size=size)

    def create_bbs_long(self):
        data = b'AWAVI\x89\xf6AUATUS\x89\xfdH\x89\xd3H\x83\xecH\xe8\xb5\xfa\xff\xff\x89\xefI\x89\xc5\xe8\xbb\xfc\xff\xffI\x89\xc4I\x8d\x85\xff\x03\x00\x00M\x85\xedI\x0fI\xc5H\xc1\xf8\nH\x89\xc1H\x89D$\x08I\x8dD\x1d\x00H\x89\xcbH\x89\xc2H\x89D$(H\x05\xfe\x07\x00\x00H\x81\xc2\xff\x03\x00\x00H\x0fI\xc2H\xc1\xe3\nH\xc1\xf8\nH\x89\\$\x10H\x89D$ H\x8b|$ i\xc1\xfb\xa2]\x9bH9|$\x08\x89D$\x1cI\x8dD$)H\x89D$8\x0f\x8d\xec\x01\x00\x00\x0f\x1f\x80\x00\x00\x00\x00H\x8b\\$\x08Hc\xc3I9D$\x10\x0f\x84\xe8\x00\x00\x00\xf2\x0f\x10\x05]\x19\x00\x00\x89\xdfA\xbf\x01\x00\x00\x00\x81\xf7\x1f\xc3;x\xf2A\x0fYD$\x08\xf2H\x0f,\xc0\x01\xc7A3<$\x03|$\x1c\xe8\x1c\xee\xff\xffH\x8bD$8I\x8d|$1\xf2\x0f\x10\x05*\x19\x00\x00H\x83\xe7\xf8H\x89\xc1H\xc7\x00\x00\x00\x00\x001\xc0H)\xf9I\xc7\x84$!\x04\x00\x00\x00\x00\x00\x00\x81\xc1\x00\x04\x00\x00\xc1\xe9\x03\xf3H\xab\xbf@B\x0f\x00\xf2A\x0fYD$\x08\xf2\x0fY\x05\xbb\x17\x00\x00\xf2\x0f\x11D$0\xe8\xd0\xed\xff\xfff\x0f\xef\xc0\x89\xc0\xf2H\x0f*\xc0\xf2\x0fXD$0\xf2\x0f^\x05\x97\x17\x00\x00\xf2\x0f,\xe8\x85\xedt0\x0f\x1f\x80\x00\x00\x00\x00\xbf\x00\x04\x00\x00\xe8\x9e\xed\xff\xff\xbf\x08\x00\x00\x00\x89\xc3\xe8\x92\xed\xff\xff\x89\xda\x89\xc1D\x89\xfb\xd3\xe3A0\\\x14)\x83\xed\x01u\xd7H\x8bD$\x08I\x89D$\x10H\x8bD$\x10H\x8bT$(H\x8d-\xe4\xca \x00L9\xe8I\x89\xc7H\x89\xd3M\x0fL\xfdH\x05\x00\x04\x00\x00H\x83D$\x08\x01H9\xd0H\x89D$\x10H\x0fN\xd8I9\xdf\x0f\x8d\x93\x00\x00\x00f\x0f\x1fD\x00\x00H\x8b5\xa9\xdb \x00H\x85\xf6t\x0cL\x89\xff\xe8<\xef\xff\xff\x85\xc0thL\x89\xf8L)\xe8L\x01\xf0\x0f\xb60\x80|5\x00\x00H\x89\xf7uRL\x89\xf9H\xc1\xf9?H\xc1\xe96I\x8d\x14\x0f\x81\xe2\xff\x03\x00\x00H)\xcaA\x0f\xb6T\x14)\x84\xd2t0\x8b\rb\xdb \x00\x83\xf9\x01tu\x0f\x82\x7f\x00\x00\x00\x83\xf9\x02u\x08\xf7\xd2!\xd7@\x0f\xb6\xf7H\x8d\x15;\xc9 \x00\x80<2\x00u\x05@\x888f\x90I\x83\xc7\x01L9\xfb\x0f\x85s\xff\xff\xff\x81l$\x1c\x05]\xa2dH\x8b|$ H9|$\x08\x0f\x8c\x1b\xfe\xff\xffA\x8bD$\x18\x85\xc0t\x10M;l$ A\xc7D$\x18\x00\x00\x00\x00t*H\x83\xc4H[]A\\A]A^A_\xc3\x0f\x1f\x00\t\xd7@\x0f\xb6\xf7\xeb\x96\x0f\x1f\x84\x00\x00\x00\x00\x001\xd7@\x0f\xb6\xf7\xeb\x86A\x0f\xb6D$(A\x88\x06H\x83\xc4H[]A\\A]A^A_\xc3'
        vaddr = 26224
        arch = 'x86_64'
        size = len(data)

        return BasicBlockSequence(TestBasicBlockSequence.config, bbs=[], data=data, vaddr=vaddr, arch=arch, size=size)

    def create_bbs_vlong(self):
        data = b'AWAVAUATE1\xedUSH\x8d\x1d\xf0U\x00\x00A\x89\xfcH\x89\xf5H\x83\xecxL\x8dt$<dH\x8b\x04%(\x00\x00\x00H\x89D$h1\xc0\xe8h&\x00\x00\xc7D$\x10\x00\x00\x00\x00I\x89\xc7\xc7D$\x1c\x00\x00\x00\x00\xc7D$\x18\x00\x00\x00\x00H\xc7D$\x08\x00\x00\x00\x00\x0f\x1f@\x00H\x8d\r\xf9x \x00H\x8d\x15\xd2V\x00\x00M\x89\xf0H\x89\xeeD\x89\xe7\xc7D$<\x00\x00\x00\x00\xe8\x9c,\x00\x00\x83\xf8\xff\x0f\x84\xa2\n\x00\x00\x8dP\xbf\x83\xfa7\x0f\x87\x90\t\x00\x00Hc\x14\x93H\x01\xda\xff\xe2\xc7D$\x18\x01\x00\x00\x00\xeb\xb4H\x8b\x05=} \x00I\x89G \xeb\xa7H\x8b\x050} \x00I\x89GH\xeb\x9aA\xc7Gl\x01\x00\x00\x00\xeb\x90H\x8d\x15\xd5R\x00\x00H\x8d5\xd3R\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8f\xfe\xff\xffH\x8d5\x8fb\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8S\xfe\xff\xffH\x8d5\xb4b\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8@\xfe\xff\xffH\x8d5\xf1b\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8-\xfe\xff\xffH\x8d5.c\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x1a\xfe\xff\xffH\x8d5kc\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x07\xfe\xff\xffH\x8d5iQ\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xf4\xfd\xff\xffH\x8d5\xdda\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xe1\xfd\xff\xffL\x89\xff\xe8I&\x00\x001\xc0H\x8b\\$hdH3\x1c%(\x00\x00\x00\x0f\x85\xcf\x15\x00\x00H\x83\xc4x[]A\\A]A^A_\xc3L\x8b\x05M| \x00A\x808=\x0f\x84r\t\x00\x001\xf6L\x89\xc7\xe8\x89\xfb\xff\xff\xf2\x0fY\x05!e\x00\x00\xf2H\x0f,\xc0I\x89\x87\x98\x00\x00\x00\xe9\x90\xfe\xff\xffL\x8b\x05\x19| \x00A\x808=\x0f\x84.\t\x00\x001\xf6L\x89\xc7\xe8U\xfb\xff\xff\xf2\x0fX\x05\xf5d\x00\x00\xf2\x0f,\xc0A\x89\x87\x80\x00\x00\x00\xe9]\xfe\xff\xffH\x8d5YP\x00\x00H\x8d=\xd4P\x00\x00\xba\x01\x00\x00\x00\xe8E\xfb\xff\xff\xe9@\xfe\xff\xffH\x8b\x05\xc9{ \x00I\x89G@\xe90\xfe\xff\xffH\x8b\x05\xb9{ \x00I\x89G8\xe9 \xfe\xff\xffL\x8b\x05\xa9{ \x00A\x808=\x0f\x84\xae\x08\x00\x00H\x8d5{P\x00\x00L\x89\xc7L\x89D$ \xe8+\xfc\xff\xff\x85\xc0L\x8bD$ \x0f\x84\x01\x08\x00\x00H\x8d5bP\x00\x00L\x89\xc7L\x89D$ \xe8\n\xfc\xff\xff\x85\xc0L\x8bD$ \x0f\x85\xb8\t\x00\x00A\xc7\x07\x01\x00\x00\x00\xe9\xc1\xfd\xff\xffL\x8b\x05J{ \x00A\x808=\x0f\x84?\x08\x00\x00\xba\n\x00\x00\x001\xf6L\x89\xc7\xe8\xf1\xfb\xff\xffA\x89\x87\x84\x00\x00\x00\xe9\x95\xfd\xff\xffH\x8b5\x1e{ \x00L\x89\xef\xe8\xa6\x16\x00\x00H\x85\xc0I\x89\xc5\x0f\x85z\xfd\xff\xffL\x8b\x05\x03{ \x00H\x8bM\x00H\x8d\x15\xa8O\x00\x00H\x8b=\xe1z \x00\xbe\x01\x00\x00\x001\xc0\xe8\xb5\xfc\xff\xffL\x89\xff\xe8\xad$\x00\x00\xb8\x01\x00\x00\x00\xe9\\\xfe\xff\xffL\x8b\x05\xccz \x00A\x808=\x0f\x84\xb1\x07\x00\x00\xba\n\x00\x00\x001\xf6L\x89\xc7\xe8s\xfb\xff\xff\xba\x00\x00\x00\x00\x85\xc0\x0fN\xc2A\x89\x87\xb8\x00\x00\x00\xe9\r\xfd\xff\xffL\x8b\x05\x96z \x00A\x808=\x0f\x84k\x07\x00\x00\xba\n\x00\x00\x001\xf6L\x89\xc7\xe8=\xfb\xff\xffA\x89G|\xe9\xe4\xfc\xff\xffH\x8b5mz \x00H\x8b|$\x08\xe8\xf3\x15\x00\x00H\x85\xc0H\x89D$\x08\x0f\x85\xc5\xfc\xff\xffL\x8b\x05Nz \x00H\x8bM\x00H\x8d\x15\xf3N\x00\x00H\x8b=,z \x00\xbe\x01\x00\x00\x00\xe8\x02\xfc\xff\xffL\x89\xff\xe8\xfa#\x00\x00\xb8\x01\x00\x00\x00\xe9\xa9\xfd\xff\xffH\x8d5\x8cN\x00\x00H\x8d=\xb5N\x00\x00\xba\x01\x00\x00\x00\xe8x\xf9\xff\xff\xe9s\xfc\xff\xffH\x8bM\x00H\x8b=\xe8y \x00H\x8d\x15\x81S\x00\x00\xbe\x01\x00\x00\x001\xc0\xe8\xb5\xfb\xff\xffL\x89\xff\xe8\xad#\x00\x00\xb8\x01\x00\x00\x00\xe9\\\xfd\xff\xffL\x8b\x05\xccy \x00A\x808=\x0f\x84\x91\x06\x00\x001\xf6L\x89\xc7\xe8\x08\xf9\xff\xff\xf2\x0fY\x05\xa0b\x00\x00\xf2H\x0f,\xc0I\x89\x87\xa0\x00\x00\x00\xe9\x0f\xfc\xff\xffA\xc7Gp\x01\x00\x00\x00\xe9\x02\xfc\xff\xffH\x8d5\xfeM\x00\x00H\x8d=ZN\x00\x00\xba\x01\x00\x00\x00\xe8\xea\xf8\xff\xff\xc7D$\x10\x01\x00\x00\x00\xe9\xdd\xfb\xff\xffA\xc7Gh\x01\x00\x00\x00\xe9\xd0\xfb\xff\xffH\x8b\x05Yy \x00I\x89G(\xe9\xc0\xfb\xff\xffL\x8b\x05Iy \x00A\x808=\x0f\x84\xfe\x05\x00\x00\xba\n\x00\x00\x001\xf6L\x89\xc7\xe8\xf0\xf9\xff\xff\x83\xe8\x01\xba\x01\x00\x00\x00~\x15H\x8b=\x1fy \x00\xba\n\x00\x00\x001\xf6\xe8\xd3\xf9\xff\xff\x89\xc2A\x89\x97\xb0\x00\x00\x00\xe9u\xfb\xff\xffH\x8d5qM\x00\x00H\x8d=\xc2M\x00\x00\xba\x01\x00\x00\x00\xe8]\xf8\xff\xff\xe9X\xfb\xff\xffL\x8b\x05\xe1x \x00A\x808=\x0f\x84\x86\x05\x00\x00L\x89\xc7\xbe:\x00\x00\x00L\x89D$(\xe8\xb5\xf8\xff\xffL\x8bD$(1\xf6\xba\n\x00\x00\x00H\x89D$ L\x89\xc7\xe8l\xf9\xff\xffH\x8bL$ A\x89GPH\x85\xc9\x0f\x84a\x07\x00\x00\x83\xc8\xff\x80y\x01\x00\x0f\x85\xd3\x06\x00\x00A\x89GT\xe9\xf4\xfa\xff\xffL\x8b\x05}x \x00A\x808=\x0f\x84\x12\x05\x00\x00L\x89\xc7\xbe:\x00\x00\x00L\x89D$(\xe8Q\xf8\xff\xffL\x8bD$(1\xf6H\x89D$ L\x89\xc7\xe8\x9d\xf7\xff\xffH\x8bD$ \xf2A\x0f\x11GXH\x85\xc0t\x0bH\x8dx\x011\xf6\xe8\x82\xf7\xff\xff\xf2A\x0f\x11G`\xe9\x97\xfa\xff\xffH\x8b\x05 x \x00I\x89G\x18\xe9\x87\xfa\xff\xffA\xc7Gt\x01\x00\x00\x00\xe9z\xfa\xff\xffL\x8b\x05\x03x \x00A\x808=\x0f\x84\x88\x04\x00\x00\xba\n\x00\x00\x001\xf6L\x89\xc7\xe8\xaa\xf8\xff\xffH\x98Hi\xc0@B\x0f\x00I\x89\x87\x90\x00\x00\x00\xe9E\xfa\xff\xffA\xc7Gx\x01\x00\x00\x00\xe98\xfa\xff\xffH\x8d5\xa1Q\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x15\xf9\xff\xffH\x8d5\xdeQ\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x02\xf9\xff\xffH\x8d5\x9cL\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xef\xf8\xff\xffH\x8d5\xa4L\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xdc\xf8\xff\xffH\x8d5\x9fL\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xc9\xf8\xff\xffH\x8d5\x9cL\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xb6\xf8\xff\xffH\x8d5\xcfQ\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xa3\xf8\xff\xffH\x8d5\x8fL\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x90\xf8\xff\xffH\x8d5\x97L\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8}\xf8\xff\xffH\x8d5\xdfK\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8j\xf8\xff\xffH\x8d5\xbbQ\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8W\xf8\xff\xffH\x8d5wL\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8D\xf8\xff\xffH\x8d5}L\x00\x00\xbf\x01\x00\x00\x001\xc0\xe81\xf8\xff\xffH\x8d5\xaaQ\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x1e\xf8\xff\xffH\x8d5\x80K\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x0b\xf8\xff\xffH\x8d5\xc4Q\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xf8\xf7\xff\xffH\x8d5\x01R\x00\x001\xc0\xbf\x01\x00\x00\x00\xe8\xe5\xf7\xff\xffH\x8d56R\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xd2\xf7\xff\xffH\x8d5sR\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xbf\xf7\xff\xffH\x8d5\xb0R\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xac\xf7\xff\xffH\x8d5\xe5R\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x99\xf7\xff\xffH\x8d5"S\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x86\xf7\xff\xffH\x8d5_S\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8s\xf7\xff\xffH\x8d5\x9cS\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8`\xf7\xff\xffH\x8d5\xd9S\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8M\xf7\xff\xffH\x8d5\xfeS\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8:\xf7\xff\xffH\x8d5+T\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\'\xf7\xff\xffH\x8d5`T\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x14\xf7\xff\xffH\x8d5\x85T\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x01\xf7\xff\xffH\x8d5\xb2T\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xee\xf6\xff\xffH\x8d5\xe7T\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xdb\xf6\xff\xffH\x8d5\x1cU\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xc8\xf6\xff\xffH\x8d5IU\x00\x001\xc0\xba\x00\x04\x00\x00\xbf\x01\x00\x00\x00\xe8\xb0\xf6\xff\xffH\x8d5\x81U\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x9d\xf6\xff\xffH\x8d5\x9eU\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x8a\xf6\xff\xffH\x8d5\xdbU\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8w\xf6\xff\xffH\x8d5\x18V\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8d\xf6\xff\xffH\x8d5MV\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8Q\xf6\xff\xff\xf2\x0f\x10\x05\xe9]\x00\x00H\x8d5rV\x00\x00\xbf\x01\x00\x00\x00\xb8\x01\x00\x00\x00\xe83\xf6\xff\xffH\x8d5\x9cV\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8 \xf6\xff\xffH\x8d5\xc1V\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\r\xf6\xff\xffH\x8d5\xf6V\x00\x001\xd2\xbf\x01\x00\x00\x001\xc0\xe8\xf8\xf5\xff\xffH\x8d5\x19W\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xe5\xf5\xff\xffH\x8d5>W\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xd2\xf5\xff\xffH\x8d5{W\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xbf\xf5\xff\xffH\x8d5\xb0W\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xac\xf5\xff\xffH\x8d5\xedW\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x99\xf5\xff\xffH\x8d5*X\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\x86\xf5\xff\xffH\x8d5WX\x00\x001\xc0\xbf\x01\x00\x00\x00\xe8s\xf5\xff\xffH\x8d5\x94X\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8`\xf5\xff\xffH\x8d5\xc9X\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8M\xf5\xff\xffH\x8d5\xeeX\x00\x00\xe9.\xf7\xff\xff\x83D$\x1c\x01\xe9G\xf6\xff\xffH\x8b\x05\xd0s \x00I\x89G0\xe97\xf6\xff\xffH\x8bM\x00H\x8b=\xacs \x00H\x8d\x15\x7fI\x00\x00A\x89\xc0\xbe\x01\x00\x00\x001\xc0\xe8v\xf5\xff\xffH\x8bU\x00H\x8d5\xa3Z\x00\x00\xbf\x01\x00\x00\x001\xc0\xe8\xef\xf4\xff\xffL\x89\xff\xe8W\x1d\x00\x00\xb8\x01\x00\x00\x00\xe9\x06\xf7\xff\xffA\xc7\x07\x00\x00\x00\x00\xe9\xe1\xf5\xff\xffI\x83\xc0\x01L\x89\x05fs \x00\xe9h\xfb\xff\xffI\x83\xc0\x01L\x89\x05Vs \x00\xe9\xde\xfa\xff\xffI\x83\xc0\x01L\x89\x05Fs \x00\xe9j\xfa\xff\xffI\x83\xc0\x01L\x89\x056s \x00\xe9\xf2\xf9\xff\xffI\x83\xc0\x01L\x89\x05&s \x00\xe9_\xf9\xff\xffI\x83\xc0\x01L\x89\x05\x16s \x00\xe9\x85\xf8\xff\xffI\x83\xc0\x01L\x89\x05\x06s \x00\xe9?\xf8\xff\xffI\x83\xc0\x01L\x89\x05\xf6r \x00\xe9\xb1\xf7\xff\xffI\x83\xc0\x01L\x89\x05\xe6r \x00\xe9B\xf7\xff\xffI\x83\xc0\x01L\x89\x05\xd6r \x00\xe9\xc2\xf6\xff\xffI\x83\xc0\x01L\x89\x05\xc6r \x00\xe9~\xf6\xff\xffA\x83\x7fh\x00t\x0bA\x83\x7fl\x00\x0f\x85x\x0b\x00\x00\x0f\xb6D$\x10\x83\xf0\x01I\x83\x7f0\x00t\x08\x84\xc0\x0f\x85D\x0b\x00\x00I\x83\x7fH\x00t\x08\x84\xc0\x0f\x85X\x01\x00\x00\xf2A\x0f\x10O`\xf2A\x0f\x10GX\xe8\x884\x00\x00A\x8b\x7fP\xe8o4\x00\x00I\x8b\x7f\x18H\x85\xfft\x05\xe8\xb1A\x00\x00I\x8b\x7f H\x85\xfft\x05\xe8\x13B\x00\x00I\x8b\x7f(H\x85\xfft\x05\xe8%4\x00\x00I\x8b\x7f8H\x85\xfft\x05\xe8\x17B\x00\x00I\x8b\x7f@H\x85\xfft\x05\xe8\x19B\x00\x00\xe8\x846\x00\x00\x8b\x1d\xceq \x00A9\xdc\x0f\x8e\x9d\x00\x00\x00\x83|$\x18\x00\x0f\x84)\x01\x00\x00\x8dC\x01A9\xc4\x0f\x8e\x1d\x01\x00\x00H\x98\x83\xc3\x021\xd2H\x8dL\xc5\x00H\x89l$\x10L\x89\xe8\x89\xddH\x89\xd3I\x89\xcdI\x8bt\xdd\x00\x80>-\x0f\x84\xb0\x00\x00\x00H\x89\xc7\xe8\x9c\x0e\x00\x00A9\xec\x0f\x8e\x01\x0b\x00\x00H\x83\xc3\x01\x83\xc5\x01\xeb\xd8H\x8dy\x01\xba\n\x00\x00\x001\xf6\xe8j\xf2\xff\xff\xe9\x18\xf9\xff\xffH\x8d5\x8eF\x00\x00L\x89\xc7L\x89D$ \xe81\xf2\xff\xff\x85\xc0L\x8bD$ \x0f\x85\xe0\n\x00\x00A\xc7\x07\x02\x00\x00\x00\xe9\xe8\xf3\xff\xffA\x83\x7ft\x00\x0f\x85F\n\x00\x00A\x8bGP\x83\xc0\x01A9GT\x0f\x84\x18\n\x00\x00H\x8bM\x00H\x8d\x151Y\x00\x00H\x8b=:q \x00\xbe\x01\x00\x00\x001\xc0\xe8\x0e\xf3\xff\xff\xe9\x93\xfd\xff\xff\x83\xc0\x01\xe9\xa4\xf8\xff\xffH\x8bM\x00H\x8d\x15\xceX\x00\x00\xeb\xd3\x80~\x01-\x0f\x85N\xff\xff\xff\x80~\x02\x00\x0f\x85D\xff\xff\xffHc\xd5I\x89\xc5H\x8bl$\x10A9\xd4~\x1fL\x89\xe8H\x89\xd3H\x8bt\xdd\x00H\x89\xc7H\x83\xc3\x01\xe8\xb9\r\x00\x00A9\xdc\x7f\xeaI\x89\xc5M\x85\xedt\x14H\x8d=\xcdF\x00\x00\xba\x01\x00\x00\x00L\x89\xee\xe88\xf0\xff\xffH\x8bD$\x08H\x85\xc0t\x14H\x8d=\xbcF\x00\x00\xba\x01\x00\x00\x00H\x89\xc6\xe8\x1a\xf0\xff\xff\x8bD$\x1cH\x8d5\x14E\x00\x00\x85\xc0t\x15\x83\xe8\x01H\x8d5\x04E\x00\x00H\x8d\x05\x01E\x00\x00H\x0fE\xf0H\x8d=\x91F\x00\x00\xba\x01\x00\x00\x00\xe8\xe5\xef\xff\xffI\x8bw\x18H\x85\xf6t\x11H\x8d=\x82F\x00\x00\xba\x01\x00\x00\x00\xe8\xcb\xef\xff\xffI\x8bw H\x85\xf6t\x11H\x8d=uF\x00\x00\xba\x01\x00\x00\x00\xe8\xb1\xef\xff\xffI\x8bw(H\x85\xf6t\x11H\x8d=fF\x00\x00\xba\x01\x00\x00\x00\xe8\x97\xef\xff\xffI\x8bw0H\x85\xf6t\x11H\x8d=VF\x00\x00\xba\x01\x00\x00\x00\xe8}\xef\xff\xffI\x8bwHH\x85\xf6t\x1a\x80>!\xba\x01\x00\x00\x00\x0f\x84A\t\x00\x00H\x8d=CF\x00\x00\xe8Z\xef\xff\xffI\x8bw8H\x85\xf6t\x11H\x8d=9F\x00\x00\xba\x01\x00\x00\x00\xe8@\xef\xff\xffI\x8bw@H\x85\xf6t\x11H\x8d=,F\x00\x00\xba\x01\x00\x00\x00\xe8&\xef\xff\xffE\x8b\x8f\x84\x00\x00\x00E\x85\xc9x9H\x8d\\$@L\x8d\x05\x16F\x00\x00\xba\x01\x00\x00\x00\xbe \x00\x00\x00\xb9 \x00\x00\x001\xc0H\x89\xdf\xe8e\xee\xff\xffH\x8d=\xf9E\x00\x00\xba\x01\x00\x00\x00H\x89\xde\xe8\xe1\xee\xff\xffIc\xbf\xb0\x00\x00\x00Hk\xffH\xe8q\xf0\xff\xff1\xd2I\x89\x87\xc0\x00\x00\x00H\x83\xc9\xff\xeb\x1cHk\xc2HH\x83\xc2\x01I\x03\x87\xc0\x00\x00\x00\xc7\x00\x00\x00\x00\x00H\x89H\x08\x89H\x10A9\x97\xb0\x00\x00\x00\x7f\xdbA\xc7\x87\xb4\x00\x00\x00\x00\x00\x00\x00E\x89g\x10E1\xedI\x89o\x08H\x89l$\x08L\x89t$\x10\xebeD\x89\xe3+\x1d\xb2n \x00Mk\xf5HI\x83\xc5\x01\x8d{\x01Hc\xdbL\x89\xf5I\x03\xaf\xc0\x00\x00\x00Hc\xffH\xc1\xe7\x03\xe8\xee\xef\xff\xffHc5\x87n \x00H\x8bL$\x08H\x8d\x14\xdd\x00\x00\x00\x00H\x89E@H\x89\xc7H\x8d4\xf1\xe8\x8a\xef\xff\xffI\x8b\x87\xc0\x00\x00\x00J\x8bD0@H\xc7\x04\xd8\x00\x00\x00\x00E9\xaf\xb0\x00\x00\x00\x7f\x92H\x8dD$@L\x8bt$\x10H\x89D$\x08f\x0f\x1fD\x00\x00A\x8b\x87\xb4\x00\x00\x00\x85\xc0u\x0eA\x8bGTA9GP\x0f\x83w\x01\x00\x00L\x89\xff\xe8\x07\x12\x00\x00\xe8\xa2\x18\x00\x00H\x89\xc5A\x8b\x87\xb0\x00\x00\x00\x85\xc0\x0f\x8e\xd8\x00\x00\x001\xdbE1\xe4I\x8b\x87\xc0\x00\x00\x00\xeb\x1af\x90A\x8b\x97\xb0\x00\x00\x00A\x83\xc4\x01H\x83\xc3HA9\xd4\x0f\x8dX\x01\x00\x00H\x8d\x14\x18\x83:\x01u\xdfA\x8bO|\x85\xc9x7;J\x14}2E\x8botE\x85\xed\x0f\x85\x98\x05\x00\x00\x8bz\x04\xbe\x0f\x00\x00\x00\xe8\xd8\xee\xff\xffI\x8b\x87\xc0\x00\x00\x00H\x8d\x14\x18H\x89j(\xc7\x02\x02\x00\x00\x00\xeb\xa1\x90I\x8b\x8f\x98\x00\x00\x00H\x85\xc9x\x94H\x03J(H9\xcd~\x8bE\x8b_tE\x85\xdbt\xbd\x8br\x18H\x8b=\xa8m \x00\xf2A\x0f\x10O`\xf2A\x0f\x10GX\xe8W\x0e\x00\x00H\x8d\x15\xe0U\x00\x00H\x8b=\x89m \x00\xbe\x01\x00\x00\x001\xc0\xe8]\xef\xff\xffH\x89\xdaI\x03\x97\xc0\x00\x00\x00\xe9y\xff\xff\xfff\x0f\x1fD\x00\x00L\x89\xff\xe8\x10\x0b\x00\x00A\x8b\x87\xb8\x00\x00\x00\x85\xc0t\x17A;\x87\xbc\x00\x00\x00\x7f\x0eA\x83\xbf\xb4\x00\x00\x00\x00\x0f\x84b\x06\x00\x00I\x83\xbf\x90\x00\x00\x00\x00\x0f\x84\xb8\xfe\xff\xff\xe8{\x17\x00\x00I+\x87\x88\x00\x00\x00I;\x87\x90\x00\x00\x00\x0f\x8c\x9f\xfe\xff\xffA\x83\xbf\xb4\x00\x00\x00\x00\x0f\x85\x91\xfe\xff\xffA\x83\x7ft\x00t\x1aH\x8b=\xfbl \x00H\x8d\x15\xc4U\x00\x00\xbe\x01\x00\x00\x001\xc0\xe8\xc8\xee\xff\xff1\xc0A\x83\xbf\xbc\x00\x00\x00\x00\x0f\x95\xc0\x89D$\x08\xe8\xb21\x00\x00L\x89\xff\xe8\xaa\x16\x00\x00\x8bD$\x08\xe9Z\xf0\xff\xff\x90\x85\xd2\x0f\x8eP\xff\xff\xffE1\xe4E1\xedH\x8d\x1d#U\x00\x00\xeb\x16f\x0f\x1f\x84\x00\x00\x00\x00\x00A\x83\xc5\x01I\x83\xc4HA9\xd5}[J\x8d\x0c \x839\x02u\xeaH\x8bq(H\x81\xc6\x80\x84\x1e\x00H9\xf5~\xdaE\x8bWtE\x85\xd2\x0f\x85\x85\x03\x00\x00\x8by\x04\xbe\t\x00\x00\x00A\x83\xc5\x01\xe8L\xed\xff\xffI\x8b\x87\xc0\x00\x00\x00A\x8b\x97\xb0\x00\x00\x00B\xc7\x04 \x03\x00\x00\x00I\x83\xc4HA9\xd5|\xaa\x0f\x1fD\x00\x00\x85\xd2\x0f\x8e\xc8\xfe\xff\xffE1\xed1\xdb\xeb$f\x0f\x1f\x84\x00\x00\x00\x00\x00\x83\xc3\x01I\x83\xc5HA;\x9f\xb0\x00\x00\x00\x0f\x8d\xa4\xfe\xff\xffI\x8b\x87\xc0\x00\x00\x00L\x01\xe8\x8b0\x8dV\xfe\x83\xfa\x02w\xd8\x8bx\x04\xba\x01\x00\x00\x00L\x89\xf6\xe8h\xed\xff\xff\x85\xc0~\xc4E\x8bOp\x8bD$<E\x85\xc9\x0f\x84\x8b\x00\x00\x00\xa8\x7f\x0f\x85\x83\x00\x00\x00\x0f\xb6\xc4\x85\xc0I\x8b\x87\xc0\x00\x00\x00\x0f\x85\xe7\x03\x00\x00A\x8b\x7ft\x85\xff\x0f\x85w\x03\x00\x001\xedL\x01\xe8Hc\xd5H\x89\xc1\x8b|\x90\x08\x85\xffx\x12\xe8\xf5\xeb\xff\xffL\x89\xe8I\x03\x87\xc0\x00\x00\x00H\x89\xc1\x83\xc5\x01\x83\xfd\x03u\xd8A\x83?\x01\x0f\x84\xce\x01\x00\x00A\x8bwh\x85\xf6\x0f\x85\xd2\x00\x00\x00A\x8bWl\x85\xd2\x0f\x85^\x02\x00\x00\xc7\x01\x00\x00\x00\x00A\x83\xaf\xb4\x00\x00\x00\x01\xe9+\xff\xff\xff\x0f\x1f\x00\x89\xc2\x83\xe2\x7f\x83\xc2\x01\x80\xfa\x01\x0f\x8e\xad\x02\x00\x00\x83\xe0\x7f\x83\xf8\x0f\x0f\x84\x83\x02\x00\x00\x83\xf8\t\x0f\x84\xa4\x02\x00\x00\x83\xf8\x18\x0f\x85\x99\x03\x00\x00E\x8b\x87\x80\x00\x00\x00E\x85\xc0\x0f\x88\x89\x03\x00\x00I\x8b\x87\xc0\x00\x00\x00H\x8d-\x98?\x00\x00B\x8bt(\x18H\x8b=\xefj \x00\xf2A\x0f\x10O`\xf2A\x0f\x10GX\xe8\x9e\x0b\x00\x00\x8bL$<\x83\xe1\x7f\x89\xcf\xe8\x90\x05\x00\x00H\x8b=\xc9j \x00H\x8d\x15bA\x00\x00I\x89\xc0I\x89\xe9\xbe\x01\x00\x00\x001\xc0\xe8\x90\xec\xff\xffA\x83\x87\xbc\x00\x00\x00\x01I\x8b\x87\xc0\x00\x00\x00\xe9\xef\xfe\xff\xff\x0f\x1f@\x00H\x8b|$\x08H\x8bp0\xe8z&\x00\x00I\x8b\x87\xc0\x00\x00\x00H\x8b=\\j \x00\xf2A\x0f\x10O`\xf2A\x0f\x10GXB\x8bt(\x18\xe8&\x0b\x00\x00\x0f\xb6L$@H\x83\xec\x08H\x8b=6j \x00\x0f\xb6D$WH\x8d\x15RC\x00\x00\xbe\x01\x00\x00\x00P\x0f\xb6D$^P\x0f\xb6D$eP\x0f\xb6D$lP\x0f\xb6D$sP\x0f\xb6D$zP\x0f\xb6\x84$\x81\x00\x00\x00P\x0f\xb6\x84$\x88\x00\x00\x00P\x0f\xb6\x84$\x8f\x00\x00\x00P\x0f\xb6\x84$\x96\x00\x00\x00P\x0f\xb6\x84$\x9d\x00\x00\x00P\x0f\xb6\x84$\xa4\x00\x00\x00P\x0f\xb6\x84$\xab\x00\x00\x00PD\x0f\xb6\x8c$\xb2\x00\x00\x001\xc0D\x0f\xb6\x84$\xb1\x00\x00\x00\xe8\xae\xeb\xff\xffH\x8b=\xa7i \x00H\x83\xc4p\xe8\xee\xea\xff\xffL\x89\xe9I\x03\x8f\xc0\x00\x00\x00\xe9Q\xfe\xff\xff\x0f\x1f\x80\x00\x00\x00\x00\x8b\x15bi \x00\x8dj\x01A9o\x10\x0f\x8e\x1f\xfe\xff\xffLc\xe5I\x8bw\x08I\xc1\xe4\x03\xeb\x0e\x0f\x1f\x84\x00\x00\x00\x00\x00\x8b\x15:i \x00\x89\xefH\x89\xc1)\xd7Hc\xd7H\x8bx@H\x8b<\xd7J;<&tL\xe8}\xe8\xff\xffI\x8b\x97\xc0\x00\x00\x00\x89\xe8+\x05\x0ei \x00J\x8bT*@H\x98H\x8b<\xc2\xe8>\xe8\xff\xffL\x89\xe8I\x03\x87\xc0\x00\x00\x00I\x8bw\x08\x89\xea+\x15\xe8h \x00N\x8b\x04&H\x8bx@H\x89\xc1Hc\xd2L\x89\x04\xd7\x83\xc5\x01I\x83\xc4\x08A;o\x10|\x89\xe9\x8e\xfd\xff\xff\x0f\x1f@\x00H\x8bx8\xe8\xb7\'\x00\x00L\x89\xe9I\x03\x8f\xc0\x00\x00\x00\xe9\x8a\xfd\xff\xff\x8bq\x18H\x8b=\xdeh \x00\xf2A\x0f\x10O`\xf2A\x0f\x10GX\xe8\x8d\t\x00\x00H\x8b=\xc6h \x00H\x89\xda\xbe\x01\x00\x00\x001\xc0\xe8\x97\xea\xff\xffL\x89\xe1I\x03\x8f\xc0\x00\x00\x00\xe9;\xfc\xff\xffI\x8b\x87\xc0\x00\x00\x00H\x8d-t=\x00\x00B\x83<(\x02\x0f\x85\x94\xfd\xff\xff\xe9\xd1\xfc\xff\xffI\x8b\x87\xc0\x00\x00\x00\xe9\xc5\xfc\xff\xffA\x83\xbf\x84\x00\x00\x00\x00\x0f\x88W\xfd\xff\xffH\x8d-\xf2<\x00\x00I\x8b\x87\xc0\x00\x00\x00\xe9b\xfd\xff\xff\x8br\x18H\x8b=Sh \x00\xf2A\x0f\x10O`\xf2A\x0f\x10GX\xe8\x02\t\x00\x00H\x8d\x15cP\x00\x00\xe9\xa6\xfa\xff\xffB\x8bt(\x18H\x8b=*h \x00\xf2A\x0f\x10O`\xf2A\x0f\x10GX\xe8\xd9\x08\x00\x00\x8bL$<\x89\xc8\x83\xe0\x7f\x83\xc0\x01,\x01\x0f\x8e\x98\x00\x00\x00\x83\xe1\x7f\x89\xcf\xe8\xbb\x02\x00\x00H\x8b=\xf4g \x00H\x8d\x15\x9c>\x00\x00I\x89\xc0\xbe\x01\x00\x00\x001\xc0\xe8\xbe\xe9\xff\xffI\x8b\x87\xc0\x00\x00\x00\xe9%\xfc\xff\xffB\x8bt(\x18H\x8b=\xc6g \x00\xf2A\x0f\x10O`\xf2A\x0f\x10GX\xe8u\x08\x00\x00\x8bD$<H\x8b=\xaag \x00H\x8d\x15:>\x00\x00\xbe\x01\x00\x00\x00\x0f\xb6\xcc1\xc0\xe8t\xe9\xff\xffA\x83\x87\xbc\x00\x00\x00\x01I\x8b\x87\xc0\x00\x00\x00\xe9\xd3\xfb\xff\xffH\x8d-S<\x00\x00I\x8b\x87\xc0\x00\x00\x00\xe9r\xfc\xff\xffH\x8b=fg \x00H\x8d\x15\xf6=\x00\x00\x0f\xb6\xcd\xbe\x01\x00\x00\x001\xc0\xe80\xe9\xff\xffI\x8b\x87\xc0\x00\x00\x00\xe9\x97\xfb\xff\xffH\x8bM\x00H\x8d\x15\xb9N\x00\x00\xe9\xf3\xf5\xff\xffL\x89\xff\xe8,\x08\x00\x00\xe9?\xfa\xff\xffH\x8bM\x00H\x8d\x15\\N\x00\x00\xe9\xd6\xf5\xff\xffA\x8bwPH\x8b=\x0cg \x00\xf2A\x0f\x10O`\xf2A\x0f\x10GX\xe8\xbb\x07\x00\x00H\x8b=\xf4f \x00H\x8d\x15\xe1<\x00\x00\xbe\x01\x00\x00\x001\xc0\xe8\xc1\xe8\xff\xff\xe9\x7f\xf5\xff\xffA\x83\x7ft\x00\x0f\x84\xe9\xf9\xff\xffH\x8b=\xcaf \x00H\x8d\x15cO\x00\x00\xbe\x01\x00\x00\x001\xc0\xe8\x97\xe8\xff\xff\xe9\xca\xf9\xff\xffI\x89\xc5H\x8bl$\x10\xe9\xd4\xf5\xff\xffH\x8d=\xf8<\x00\x00\xe8\x19\xe6\xff\xff\xe9\xba\xf6\xff\xffH\x8bM\x00H\x8d\x15Q@\x00\x00\xe9\x9c\xeb\xff\xff\xe8_\xe6\xff\xff'
        vaddr = 6272
        arch = 'x86_64'
        size = len(data)

        return BasicBlockSequence(TestBasicBlockSequence.config, bbs=[], data=data, vaddr=vaddr, arch=arch, size=size)


    def test_vex_lift(self):
        bbs = self.create_bbs()
        bbs.analyse()
        ##has to invalidate rdx as a temporary variable is written to it first
        self.assertEqual(bbs.vex['arguments'], set([ 'rsi', 'rdi' ]))

        print('Analysing large function')
        big_bbs = self.create_bbs_long()
        big_bbs.analyse()
        self.assertEqual( big_bbs.vex['arguments'], set( [ 'rdi', 'rsi', 'rdx' ] ) )

        print('Analysing main function')
        vbig_bbs = self.create_bbs_vlong()
        vbig_bbs.analyse()
        ##main function hat has 3 args but only references 2
        self.assertEqual( vbig_bbs.vex['arguments'], set( [ 'rdi', 'rsi' ] ) )

        

if __name__ == '__main__':
    unittest.main()
